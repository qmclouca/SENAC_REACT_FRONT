import*as e from"react";import{PrimeReactContext as t}from"primereact/api";import{ComponentBase as n,useHandleStyle as r}from"primereact/componentbase";import{useMergeProps as o}from"primereact/hooks";import{Tooltip as l}from"primereact/tooltip";import{classNames as a,ObjectUtils as i,DomHandler as u}from"primereact/utils";import{Ripple as c}from"primereact/ripple";function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e){if(Array.isArray(e))return p(e)}function m(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function f(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function b(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e){return d(e)||m(e)||f(e)||b()}function y(e){if(Array.isArray(e))return e}function h(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,a,i=[],u=!0,c=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,t){return y(e)||h(e,t)||f(e,t)||g()}var E=n.extend({defaultProps:{__TYPE:"SelectButton",id:null,value:null,options:null,optionLabel:null,optionValue:null,optionDisabled:null,tabIndex:null,multiple:!1,invalid:!1,unselectable:!0,allowEmpty:!0,disabled:!1,style:null,className:null,dataKey:null,tooltip:null,tooltipOptions:null,itemTemplate:null,onChange:null,children:void 0},css:{classes:{root:function(e){return a("p-selectbutton p-button-group p-component",{"p-invalid":e.props.invalid})},button:function(e){var t=e.itemProps;return a("p-button p-component",{"p-highlight":t.selected,"p-disabled":t.disabled,"p-focus":e.focusedState})},label:"p-button-label p-c"}}}),S=e.memo((function(t){var n,r=x(e.useState(!1),2),l=r[0],u=r[1],s=o(),p=t.ptm,d=t.cx,m=function(e){return p(e,{hostName:t.hostName,context:{selected:t.selected,disabled:t.disabled,option:t.option}})},f=function(e,n){t.setFocusedIndex(n),t.onClick&&t.onClick({originalEvent:e,option:t.option})},b=function(e,t){switch(e.code){case"Space":f(e,t),e.preventDefault();break;case"ArrowDown":case"ArrowRight":v(e,"next"),e.preventDefault();break;case"ArrowUp":case"ArrowLeft":v(e,"prev"),e.preventDefault()}},v=function(e,n){for(var r,o,l=0;l<=t.elementRef.current.children.length-1;l++)"0"===t.elementRef.current.children[l].getAttribute("tabindex")&&(r={elem:t.elementRef.current.children[l],index:l});t.setFocusedIndex(o="prev"===n?0===r.index?t.elementRef.current.children.length-1:r.index-1:r.index===t.elementRef.current.children.length-1?0:r.index+1),t.elementRef.current.children[o].focus()},y=(n=s({className:d("label")},m("label")),t.template?i.getJSXElement(t.template,t.option):e.createElement("span",n,t.label)),h=s({className:a(t.className,d("button",{itemProps:t,focusedState:l})),role:"button","aria-label":t.label,"aria-pressed":t.selected,onClick:function(e){return f(e,t.index)},onKeyDown:function(e){return b(e,t.index)},tabIndex:t.tabIndex,"aria-disabled":t.disabled,onFocus:function(){u(!0)},onBlur:function(){u(!1)}},m("button"));return e.createElement("div",h,y,!t.disabled&&e.createElement(c,null))}));S.displayName="SelectButtonItem";var w=e.memo(e.forwardRef((function(n,c){var p=o(),d=e.useContext(t),m=E.getProps(n,d),f=x(e.useState(0),2),b=f[0],y=f[1],h=e.useRef(null),g=E.setMetaData({props:m}),w=g.ptm,D=g.cx;r(E.css.styles,g.isUnstyled,{name:"selectbutton",styled:!0});var A=function(e){if(!m.disabled&&!O(e.option)){var t=F(e.option);if(!t||m.unselectable&&m.allowEmpty){var n,r=N(e.option);if(m.multiple){var o=m.value?v(m.value):[];n=t?o.filter((function(e){return!i.equals(e,r,m.dataKey)})):[].concat(v(o),[r])}else n=t?null:r;m.onChange&&m.onChange({originalEvent:e.originalEvent,value:n,stopPropagation:function(){e.originalEvent.stopPropagation()},preventDefault:function(){e.originalEvent.preventDefault()},target:{name:m.name,id:m.id,value:n}})}}},I=function(e){return m.optionLabel?i.resolveFieldData(e,m.optionLabel):e&&void 0!==e.label?e.label:e},N=function(e){return m.optionValue?i.resolveFieldData(e,m.optionValue):e&&void 0!==e.value?e.value:e},O=function(e){return m.optionDisabled?i.isFunction(m.optionDisabled)?m.optionDisabled(e):i.resolveFieldData(e,m.optionDisabled):!(!e||void 0===e.disabled)&&e.disabled},F=function(e){var t=N(e);return m.multiple?!(!m.value||!m.value.length)&&m.value.some((function(e){return i.equals(e,t,m.dataKey)})):i.equals(m.value,t,m.dataKey)};e.useImperativeHandle(c,(function(){return{props:m,focus:function(){return u.focusFirstElement(h.current)},getElement:function(){return h.current}}}));var R=i.isNotEmpty(m.tooltip),j=m.options&&m.options.length?m.options.map((function(t,n){var r=m.disabled||O(t),o=I(t),l=m.disabled||n!==b?"-1":"0",a=F(t);return e.createElement(S,{hostName:"SelectButton",key:o+"_"+n,label:o,className:t.className,option:t,setFocusedIndex:y,onClick:A,template:m.itemTemplate,selected:a,tabIndex:l,index:n,disabled:r,ptm:w,cx:D,elementRef:h})})):null,C=p({ref:h,id:m.id,className:a(m.className,D("root")),style:m.style,role:"group"},E.getOtherProps(m),w("root"));return e.createElement(e.Fragment,null,e.createElement("div",C,j,m.children),R&&e.createElement(l,s({target:h,content:m.tooltip,pt:w("tooltip")},m.tooltipOptions)))})));w.displayName="SelectButton";export{w as SelectButton};
