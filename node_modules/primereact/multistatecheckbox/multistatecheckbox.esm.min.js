import*as e from"react";import{PrimeReactContext as t,ariaLabel as n}from"primereact/api";import{ComponentBase as o,useHandleStyle as r}from"primereact/componentbase";import{useMergeProps as l,useUpdateEffect as i,useMountEffect as a}from"primereact/hooks";import{CheckIcon as c}from"primereact/icons/check";import{Tooltip as u}from"primereact/tooltip";import{classNames as s,DomHandler as p,ObjectUtils as f,IconUtils as d}from"primereact/utils";function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},m.apply(this,arguments)}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function y(e,t){if("object"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==b(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function v(e){var t=y(e,"string");return"symbol"===b(t)?t:String(t)}function h(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){if(Array.isArray(e))return e}function O(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,l,i,a=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=l.call(n)).done)&&(a.push(o.value),a.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return a}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function k(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}function P(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var j=o.extend({defaultProps:{__TYPE:"Checkbox",autoFocus:!1,checked:!1,className:null,disabled:!1,falseValue:!1,icon:null,id:null,inputId:null,inputRef:null,invalid:!1,variant:null,name:null,onChange:null,onContextMenu:null,onMouseDown:null,readOnly:!1,required:!1,style:null,tabIndex:null,tooltip:null,tooltipOptions:null,trueValue:!0,value:null,children:void 0},css:{classes:{box:"p-checkbox-box",input:"p-checkbox-input",icon:"p-checkbox-icon",root:function(e){var t=e.props,n=e.context;return s("p-checkbox p-component",{"p-highlight":e.checked,"p-disabled":t.disabled,"p-invalid":t.invalid,"p-variant-filled":t.variant?"filled"===t.variant:n&&"filled"===n.inputStyle})}}}});function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=e.memo(e.forwardRef((function(n,o){var b=l(),y=e.useContext(t),v=j.getProps(n,y),h=j.setMetaData({props:v,context:{checked:v.checked===v.trueValue,disabled:v.disabled}}),g=h.ptm,O=h.cx;r(j.css.styles,h.isUnstyled,{name:"checkbox"});var x=e.useRef(null),k=e.useRef(v.inputRef),P=function(){return v.checked===v.trueValue},E=function(e){if(!v.disabled&&!v.readonly&&v.onChange){var t,n=P()?v.falseValue:v.trueValue;if(null==v||null===(t=v.onChange)||void 0===t||t.call(v,{originalEvent:e,value:v.value,checked:n,stopPropagation:function(){null==e||e.stopPropagation()},preventDefault:function(){null==e||e.preventDefault()},target:{type:"checkbox",name:v.name,id:v.id,value:v.value,checked:n}}),e.defaultPrevented)return;p.focus(k.current)}};e.useImperativeHandle(o,(function(){return{props:v,focus:function(){return p.focus(k.current)},getElement:function(){return x.current},getInput:function(){return k.current}}})),e.useEffect((function(){f.combinedRefs(k,v.inputRef)}),[k,v.inputRef]),i((function(){k.current.checked=P()}),[v.checked,v.trueValue]),a((function(){v.autoFocus&&p.focus(k.current,v.autoFocus)}));var w,D,I,C,N,F=P(),R=f.isNotEmpty(v.tooltip),V=j.getOtherProps(v),A=b({id:v.id,className:s(v.className,O("root",{checked:F,context:y})),style:v.style,"data-p-highlight":F,"data-p-disabled":v.disabled,onContextMenu:v.onContextMenu,onMouseDown:v.onMouseDown},V,g("root"));return e.createElement(e.Fragment,null,e.createElement("div",m({ref:x},A),(C=f.reduceKeys(V,p.ARIA_PROPS),N=b(S({id:v.inputId,type:"checkbox",className:O("input"),name:v.name,tabIndex:v.tabIndex,onFocus:function(e){var t;null==v||null===(t=v.onFocus)||void 0===t||t.call(v)},onBlur:function(e){var t;null==v||null===(t=v.onBlur)||void 0===t||t.call(v)},onChange:function(e){return E(e)},disabled:v.disabled,readOnly:v.readOnly,required:v.required,"aria-invalid":v.invalid,checked:F},C),g("input")),e.createElement("input",m({ref:k},N))),(w=b({className:O("icon")},g("icon")),D=b({className:O("box",{checked:F}),"data-p-highlight":F,"data-p-disabled":v.disabled},g("box")),I=d.getJSXIcon(F?v.icon||e.createElement(c,w):null,S({},w),{props:v,checked:F}),e.createElement("div",D,I))),R&&e.createElement(u,m({target:x,content:v.tooltip,pt:g("tooltip")},v.tooltipOptions)))})));w.displayName="Checkbox";var D=o.extend({defaultProps:{__TYPE:"MultiStateCheckbox",autoFocus:!1,className:null,dataKey:null,disabled:!1,empty:!0,iconTemplate:null,id:null,onChange:null,optionIcon:null,optionLabel:null,optionValue:null,options:null,readOnly:!1,style:null,tabIndex:"0",tooltip:null,tooltipOptions:null,value:null,children:void 0},css:{classes:{icon:function(e){return s("p-checkbox-icon p-c",h({},"".concat(e.icon),!0))},root:function(e){return s("p-multistatecheckbox p-checkbox p-component",e.props.classNames)}},inlineStyles:{checkbox:function(e){var t=e.selectedOption;return t&&t.style}}}});function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=e.memo(e.forwardRef((function(o,i){var c,b,y=l(),v=e.useContext(t),x=D.getProps(o,v),j=e.useState(!1),E=(b=2,g(c=j)||O(c,b)||k(c,b)||P()),S=E[0],I=E[1],N=e.useRef(null),F=x.optionValue?null:x.dataKey,R=D.setMetaData({props:x,state:{focused:S}}),V=R.ptm,A=R.cx,M=R.sx;r(D.css.styles,R.isUnstyled,{name:"multistatecheckbox"});var T=function(e){x.disabled||x.readOnly||K(e)},_=function(e){return x.optionValue?f.resolveFieldData(e,x.optionValue):e},K=function(e){if(x.onChange){var t=_(x.options?U===x.options.length-1?x.empty?null:x.options[0]:x.options[U+1]:null);x.onChange({originalEvent:e,value:t,stopPropagation:function(){null==e||e.stopPropagation()},preventDefault:function(){null==e||e.preventDefault()},target:{name:x.name,id:x.id,value:t}})}};e.useImperativeHandle(i,(function(){return{props:x,focus:function(){return p.focusFirstElement(N.current)},getElement:function(){return N.current}}})),a((function(){x.empty||null!==x.value||K(),x.autoFocus&&p.focusFirstElement(N.current)}));var q,B,J=(x.options&&(B=x.options.findIndex((function(e){return f.equals(x.value,_(e),F)})),q=x.options[B]),{option:q,index:B}),L=J.option,U=J.index,X=f.isNotEmpty(x.tooltip),H=D.getOtherProps(x),Y=f.reduceKeys(H,p.ARIA_PROPS),$=function(){var e=L&&f.resolveFieldData(L,x.optionIcon||"icon")||"",t=s("p-checkbox-icon p-c",h({},"".concat(e),!0)),n=y({className:A("icon",{icon:e})},V("icon")),o=d.getJSXIcon(e,C({},n),{props:x});return x.iconTemplate?f.getJSXElement(x.iconTemplate,{option:L,className:t,element:o,props:x}):o}(),z=L?function(e){var t=x.optionLabel||x.optionValue;return t?f.resolveFieldData(e,t):e}(L):n("nullLabel"),G=L?"true":"false",Q=y({ref:N,id:x.id,className:s(x.className,A("root")),style:x.style,onClick:T},D.getOtherProps(x),V("root")),W=y(C({className:s(x.className),style:M("checkbox",{selectedOption:L}),tabIndex:x.tabIndex,onFocus:function(){I(!0)},onBlur:function(){I(!1)},onKeyDown:function(e){32===e.keyCode&&(K(e),e.preventDefault())},role:"checkbox","aria-checked":G,onChange:T,checked:!!L,disabled:null==x?void 0:x.disabled,icon:$},Y),V("checkbox")),Z=y({className:"p-sr-only p-hidden-accessible","aria-live":"polite"},V("srOnlyAria"));return e.createElement(e.Fragment,null,e.createElement("div",Q,e.createElement(w,W),S&&e.createElement("span",Z,z)),X&&e.createElement(u,m({target:N,content:x.tooltip,pt:V("tooltip")},x.tooltipOptions)))})));N.displayName="MultiStateCheckbox";export{N as MultiStateCheckbox};
